<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace= "member" >
	
    <select id="getMemberByBusinessNumber" resultType="map">
    	/* member.getMemberByBusinessNumber */
		SELECT
		  MEMBERID,
		  STARTBUSINESSDESIREYN,
		  FRANCHISEJOINYN,
		  ITEM,
		  PHONENUMBER,
		  PHONENUMBER2,
		  ADDRESS1,
		  ADDRESS2,
		  BIRTHDAY,
		  APPENGAGEDATE,
		  ESEROEXTRACT,
		  BEFORESALES,
		  LASTCONSULTDATE,
		  AVAILABLEMONEY,
		  BUSINESSTYPE,
		  MEMBERNAME,
		  BUSINESSNUMBER,
		  GENDER,
		  MEMBERTYPE,
		  ESEROJOINYN,
		  TAXACCOUNTACCEPTYN,
		  OPENDATE,
		  ISDELETED,
		  CREATIONDATE,
		  MODIFICATIONDATE,
		  (
		  	SELECT DEVICEID FROM DEVICE 
		  	WHERE MEMBERID = A.MEMBERID 
			<if test="identifyUid != null">
			AND IDENTIFYUID = #{identifyUid}
			</if>	
			<if test="identifyUid == null">
			AND IDENTIFYUID = 'SERVER'
			</if>
			) AS DEVICEID
		FROM 
		  MEMBER A
		WHERE
		  BUSINESSNUMBER = #{businessNumber}
    </select>
      
    <insert id="insertMember">
        INSERT INTO MEMBER
        (
		MEMBERID
		,STARTBUSINESSDESIREYN
		,FRANCHISEJOINYN
		,ITEM
		,PHONENUMBER
		,PHONENUMBER2
		,ADDRESS1
		,ADDRESS2
		,BIRTHDAY
		,APPENGAGEDATE
		,ESEROEXTRACT
		,BEFORESALES
		,LASTCONSULTDATE
		,AVAILABLEMONEY
		,BUSINESSTYPE
		,MEMBERNAME
		,BUSINESSNUMBER
		,GENDER
		,MEMBERTYPE
		,ESEROJOINYN
		,TAXACCOUNTACCEPTYN
		,OPENDATE
		,ISDELETED
		,CREATIONDATE
		,MODIFICATIONDATE   
		)
		VALUES
		{
		}     
    </insert>
    
</mapper>