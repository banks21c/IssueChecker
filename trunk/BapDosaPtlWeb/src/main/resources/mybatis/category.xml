<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="category">
	<select id="getCategoryList" resultType="map">
	SELECT
		MEMBERID,
		DEVICEID,
		CATEGORYID,
		NAME,
		SORTORDER,
		ISETC,
		ISSERVICE,
		ISEDITABLE,		
		CREATIONDATE,
		MODIFICATIONDATE		
	FROM CATEGORY
	WHERE MEMBERID = #{memberid} AND ISEDITABLE = #{iseditable}
	ORDER BY SORTORDER
	</select>
	
	<select id="getCategoryJsonList" resultType="map">
	SELECT
		MEMBERID,
		DEVICEID,
		CATEGORYID,
		NAME,
		SORTORDER,
		ISETC,
		ISSERVICE,
		ISEDITABLE,		
		CREATIONDATE,
		MODIFICATIONDATE		
	FROM CATEGORY
	WHERE MEMBERID = #{memberid}
	ORDER BY SORTORDER
	</select>
	
	<select id="getCategoryMenuJsonList" resultType="map">
	SELECT
		MEMBERID,
		DEVICEID,
		CATEGORYID,
		MENUID,
		NAME,
		SORTORDER,		
		NVL(STOREPRICE,0) STOREPRICE,
		NVL(DELIVERYPRICE,0) DELIVERYPRICE,
		NVL(TAKEOUTPRICE,0) TAKEOUTPRICE,
		NVL(STOREPOINT,0) STOREPOINT,
		NVL(DELIVERYPOINT,0) DELIVERYPOINT,
		NVL(TAKEOUTPOINT,0) TAKEOUTPOINT,
		NVL(STOREDISCOUNT,0) STOREDISCOUNT,
		NVL(DELIVERYDISCOUNT,0) DELIVERYDISCOUNT,
		NVL(TAKEOUTDISCOUNT,0) TAKEOUTDISCOUNT,
		ISHIDDEN,
		ISDELETED,
		CREATIONDATE,
		MODIFICATIONDATE
		
	FROM  MENU
	WHERE MEMBERID = #{memberid} AND CATEGORYID= #{categoryid} AND ISDELETED = #{isdeleted}
    ORDER BY SORTORDER 
	</select>
	
	<insert id="insertCategory" parameterType="com.goodbyenote.bapdosaptlweb.pos.model.CategoryVO">
		INSERT INTO CATEGORY (MEMBERID,
	            DEVICEID,
	            CATEGORYID,	            
	            NAME,
	            SORTORDER,
	            ISETC,
	            ISSERVIVE,
	            ISEDITABLE
	            )	            
	            
		VALUES (#{memberid},
				0,
				#{categoryid},				
				#{name},
				#{sortorder,jdbcType=VARCHAR},
				#{isetc ,jdbcType=VARCHAR},
				#{isservice,jdbcType=VARCHAR},
				#{iseditable,jdbcType=VARCHAR}				
				)
				
		)
	</insert>
	
	<!-- 수정 -->
	<update id="updateCategory" parameterType="com.goodbyenote.bapdosaptlweb.pos.model.CategoryVO">
		UPDATE CATEGORY
		SET    
		       
		       NAME             = #{name},
		       SORTORDER        = #{sortorder}
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}
		AND    CATEGORYID       = #{categoryid}
	</update>
	
	<select id="getCategoryMenuList" resultType="map">
	SELECT
		MEMBERID,
		DEVICEID,
		CATEGORYID,
		MENUID,
		NAME,
		SORTORDER,		
		STOREPRICE,
		DELIVERYPRICE,
		TAKEOUTPRICE,
		STOREPOINT,
		DELIVERYPOINT,
		TAKEOUTPOINT,
		STOREDISCOUNT,
		DELIVERYDISCOUNT,
		TAKEOUTDISCOUNT,
		ISHIDDEN,
		ISDELETED,
		CREATIONDATE,
		MODIFICATIONDATE
		
	FROM MENU
	WHERE MEMBERID = #{memberid} AND CATEGORYID= #{categoryid} AND ISDELETED = #{isdeleted}
    ORDER BY SORTORDER 
	</select>
	
	<select id="getCategoryPointList" resultType="com.goodbyenote.bapdosaptlweb.pos.model.MenuVO" >
	SELECT
		MEMBERID,
		DEVICEID,
		CATEGORYID,
		MENUID,
		NAME,
		SORTORDER,		
		STOREPRICE,
		DELIVERYPRICE,
		TAKEOUTPRICE,
		STOREPOINT,
		DELIVERYPOINT,
		TAKEOUTPOINT,
		STOREDISCOUNT,
		DELIVERYDISCOUNT,
		TAKEOUTDISCOUNT,
		ISHIDDEN,
		ISDELETED,
		CREATIONDATE,
		MODIFICATIONDATE
		
	FROM MENU
	WHERE MEMBERID = #{memberid} AND CATEGORYID= #{categoryid} AND ISDELETED = #{isdeleted}
    ORDER BY SORTORDER 
	</select>
	
	<select id="getMenuDiffer" resultType="map">
        /* possetting.getMenuDiffer */
		SELECT
		     SETTINGVALUE
			,CREATIONDATE
			,MODIFICATIONDATE
		FROM
			SETTING
		WHERE
			MEMBERID = #{memberid}			
			AND DEVICEID = #{deviceid}
			AND SETTINGKEY = 'CC00002100'
    </select>
    
    <select id="getDcDiffer" resultType="map">
        /* possetting.getDcDiffer */
		SELECT
		     SETTINGVALUE
			,CREATIONDATE
			,MODIFICATIONDATE
		FROM
			SETTING
		WHERE
			MEMBERID = #{memberid}			
			AND DEVICEID = #{deviceid}
			AND SETTINGKEY = 'CC00002200'
    </select>
    
    <select id="getDcPointChoice" resultType="map">
        /* possetting.getDcPointChoice */
		SELECT
		     SETTINGVALUE
			,CREATIONDATE
			,MODIFICATIONDATE
		FROM
			SETTING
		WHERE
			MEMBERID = #{memberid}			
			AND DEVICEID = #{deviceid}
			AND SETTINGKEY = 'CC00002300'
    </select>
	
	<insert id="insertCateMenu" parameterType="map">
		INSERT INTO MENU (
		        MEMBERID,
	            DEVICEID,
	            CATEGORYID,
	            MENUID,
	            NAME,
	            SORTORDER,	            
	            STOREPRICE,
	            DELIVERYPRICE,
	            TAKEOUTPRICE	            
	           )
		VALUES ( 
		        #{memberid},
				#{deviceid},
				#{categoryid},
				#{menuid},
				#{name},
				#{sortorder},				
				#{storeprice},
				#{deliveryprice},
				#{takeoutprice}
									
		       )
	</insert>
	
	<!-- 수정 -->
	<update id="updateCateMenu" parameterType="com.goodbyenote.bapdosaptlweb.pos.model.MenuVO">
		UPDATE MENU
		SET    	
		        MENUID              = #{menuid, jdbcType=NUMERIC},	        
	            CATEGORYID          = #{categoryid , jdbcType=NUMERIC},
	            NAME                = #{name , jdbcType=VARCHAR},
	            SORTORDER           = #{sortorder , jdbcType=NUMERIC},	           
	            STOREPRICE          = #{storeprice , jdbcType=NUMERIC},
	            DELIVERYPRICE	    = #{deliveryprice , jdbcType=NUMERIC},
	            TAKEOUTPRICE        = #{takeoutprice , jdbcType=NUMERIC},
	            ISHIDDEN            = #{ishidden , jdbcType=VARCHAR},
	            ISDELETED           = #{isdeleted , jdbcType=VARCHAR}	       
		       
		WHERE  MEMBERID         = #{memberid , jdbcType=VARCHAR}
		AND    DEVICEID         = #{deviceid , jdbcType=NUMERIC}
		AND    MENUID           = #{menuid , jdbcType=NUMERIC}		
	</update>
	
	<update id="updateCatePoint" parameterType="com.goodbyenote.bapdosaptlweb.pos.model.MenuVO">
		UPDATE MENU
		SET    	
		        MENUID              = #{menuid, jdbcType=NUMERIC},	        
	            CATEGORYID          = #{categoryid , jdbcType=NUMERIC},
	            NAME                = #{name , jdbcType=VARCHAR},
	            SORTORDER           = #{sortorder , jdbcType=NUMERIC},	           
	            STOREPOINT          = #{storepoint , jdbcType=NUMERIC},
	            DELIVERYPOINT	    = #{deliverypoint , jdbcType=NUMERIC},
	            TAKEOUTPOINT        = #{takeoutpoint , jdbcType=NUMERIC},
	            STOREDISCOUNT       = #{storediscount , jdbcType=NUMERIC},
	            DELIVERYDISCOUNT    = #{deliverydiscount , jdbcType=NUMERIC},
	            TAKEOUTDISCOUNT     = #{takeoutdiscount , jdbcType=NUMERIC}	       
		       
		WHERE  MEMBERID         = #{memberid , jdbcType=VARCHAR}
		AND    DEVICEID         = #{deviceid , jdbcType=NUMERIC}
		AND    MENUID           = #{menuid , jdbcType=NUMERIC}		
	</update>
	
	<update id="updateMenuDiffer">
        /* possetting.updateMenuDiffer */
        
		UPDATE SETTING
		SET    		       
		       SETTINGVALUE     = #{settingvalue}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}		
		AND    SETTINGKEY       = 'CC00002100'  
    </update>
    
    <update id="updateDcDiffer">
        /* possetting.updateDcDiffer */
        
		UPDATE SETTING
		SET    		       
		       SETTINGVALUE     = #{settingvalue}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}		
		AND    SETTINGKEY       = 'CC00002200'  
    </update>
    
    <update id="updateDcPointChoice">
        /* possetting.updateDcPointChoice */
        
		UPDATE SETTING
		SET    		       
		       SETTINGVALUE     = #{settingvalue}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}		
		AND    SETTINGKEY       = 'CC00002300'  
    </update>  
	
</mapper>