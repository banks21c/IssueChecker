<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace= "possetting" >	
  

    <insert id="insertCustomerRequest">
        /* possetting.insertCustomerRequest */
		INSERT INTO CUSTOMERREQUEST
		(
			MEMBERID
			,DEVICEID
			,REQUESTID
			,CONTENTS
			,CREATIONDATE
			,MODIFICATIONDATE
		) VALUES (
			#{memberId}
			,#{deviceId}
			,#{requestId}
			,#{contents}
			,SYSDATE
			,SYSDATE
		)     
    </insert>
    
    <select id="getCustomerRequestList" resultType="map">
        /* possetting.getCustomerRequestList */
		SELECT
			 MEMBERID
			,DEVICEID
			,REQUESTID
			,CONTENTS
			,ISDELETED
			,CREATIONDATE
			,MODIFICATIONDATE
		FROM
			CUSTOMERREQUEST
		WHERE
			MEMBERID = #{memberId}
			<if test="isDeleted != null">
			AND ISDELETED = #{isDeleted}
			</if>
    </select>
    
    <select id="getPointDcList" resultType="map">
        /* possetting.getPointDcList */
		SELECT
			 MEMBERID
			,DEVICEID
			,SETTINGID
			,SETTINGKEY
			,SETTINGVALUE
			,CREATIONDATE
			,MODIFICATIONDATE
		FROM
			SETTING
		WHERE
			MEMBERID = #{memberid}			
			AND DEVICEID = #{deviceid}
			AND SETTINGKEY LIKE 'CC000029%'
			
    </select>
    
    <select id="getRankList" resultType="map">
        /* possetting.getRankList */
		SELECT
			  A.CODENAME,
		      B.SETTINGKEY,
		      B.SETTINGVALUE,
		      B.MEMBERID,
		      B.DEVICEID
		FROM
			  COMMONCODE A JOIN SETTING B ON A.CODE = B.SETTINGKEY
		WHERE	
			 B.MEMBERID = #{memberid}			
			 AND B.DEVICEID = #{deviceid}	
			 AND A.PARENTCODE = 'CC00002500'
		ORDER BY A.CODE	
    </select>
    
    <select id="getRankList2" resultType="map">
        /* possetting.getRankList2 */
		SELECT
			  A.CODENAME,
		      B.SETTINGKEY,
		      B.SETTINGVALUE,
		      B.MEMBERID,
		      B.DEVICEID
		FROM
			  COMMONCODE A JOIN SETTING B ON A.CODE = B.SETTINGKEY
		WHERE	
			 B.MEMBERID = #{memberid}			
			 AND B.DEVICEID = #{deviceid}	
			 AND A.PARENTCODE = 'CC00002600'
		ORDER BY A.CODE	
    </select>             

    <update id="updateTableCount">
        /* possetting.updateTableCount */
        
		UPDATE ORDERTABLE
		SET    		       
		       ISDELETED        = #{isdeleted}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}
		AND    TABLENO          > #{tableno} 
    </update>
    
    <update id="updateTableCount2">
        /* possetting.updateTableCount */
        
		UPDATE ORDERTABLE
		SET    		       
		       ISDELETED        = #{isdeleted}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}
		AND    TABLENO  <![CDATA[ <= ]]>  #{tableno} 
    </update>
    
    <update id="updateDcAmount">
        /* possetting.updateDcAmount */
        
		UPDATE SETTING
		SET    		       
		       SETTINGVALUE     = #{settingvalue}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}
		AND    SETTINGID        = #{settingid}
		AND    SETTINGKEY       = #{settingkey}  
    </update>
    
    <update id="updateRank">
        /* possetting.updateRank */
        
		UPDATE SETTING
		SET    		       
		       SETTINGVALUE     = #{settingvalue}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}		
		AND    SETTINGKEY       = #{settingkey}  
    </update>    
    
    <update id="updateCustomerRequest">
        /* possetting.updateCustomerRequest */
        
		UPDATE CUSTOMERREQUEST
		SET    		       
		       CONTENTS         = #{contents}		       
		WHERE  MEMBERID         = #{memberid}
		AND    DEVICEID         = #{deviceid}
		AND    REQUESTID        = #{requestid} 
    </update>    

</mapper>